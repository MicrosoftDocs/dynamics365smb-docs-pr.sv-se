---
title: Designdetaljer - Bokföringsstruktur för artikelspårning | Microsoft Docs
description: Lär dig att använda artikeltransaktioner som den primära bäraren av artikelspårningsnummerartikelspårning.
services: project-madeira
documentationcenter: ''
author: SorenGP
ms.service: dynamics365-business-central
ms.topic: article
ms.devlang: na
ms.tgt_pltfrm: na
ms.workload: na
ms.search.keywords: design, item tracking, posting, inventory
ms.date: 10/01/2019
ms.author: sgroespe
ms.openlocfilehash: 082c5c70ce0fc060b5a3d87c325e1762873113ee
ms.sourcegitcommit: 02e704bc3e01d62072144919774f1244c42827e4
ms.translationtype: HT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/01/2019
ms.locfileid: "2303250"
---
# <a name="design-details-item-tracking-posting-structure"></a><span data-ttu-id="421e5-103">Designdetaljer: Bokföringsstruktur för artikelspårning</span><span class="sxs-lookup"><span data-stu-id="421e5-103">Design Details: Item Tracking Posting Structure</span></span>
<span data-ttu-id="421e5-104">För att anpassas till funktionen för lagervärdering och för att få en enklare och mer robust lösning används artikeltransaktioner som den primära bäraren av artikelspårningsnummer.</span><span class="sxs-lookup"><span data-stu-id="421e5-104">To align with inventory costing functionality and to obtain a simpler and more robust solution, item ledger entries are used as the primary carrier of item tracking numbers.</span></span>  
  
<span data-ttu-id="421e5-105">Artikelspårningsnummer i ordernätverksenheter och icke orderrelaterade nätverksenheter anges i fältet **Reservationstransaktion** tabell (T337).</span><span class="sxs-lookup"><span data-stu-id="421e5-105">Item tracking numbers on order network entities and non-order network entities are specified in the **Reservation Entry** table (T337).</span></span> <span data-ttu-id="421e5-106">Artikelspårningsnummer som är kopplade till historisk information hämtas direkt från de artikeltransaktioner som hör till transaktionen i fråga.</span><span class="sxs-lookup"><span data-stu-id="421e5-106">Item tracking numbers that are related to historical information are retrieved directly from the item ledger entries that are related to the transaction in question.</span></span> <span data-ttu-id="421e5-107">Det betyder att artikeltransaktioner återspeglar artikelspårningspecifikationen för den bokförda orderraden.</span><span class="sxs-lookup"><span data-stu-id="421e5-107">This means that item ledger entries reflect the item tracking specification of the posted order line.</span></span>  
  
<span data-ttu-id="421e5-108">Sidan **Artikelspårningsrader** hämtar informationen från T337 och artikeltransaktionerna och visar den via den tillfälliga tabellen, **Spårningsspecifikation** (T336).</span><span class="sxs-lookup"><span data-stu-id="421e5-108">The **Item Tracking Lines** page retrieves the information from T337 and the item ledger entries and shows it through the temporary table, **Tracking Specification** (T336).</span></span> <span data-ttu-id="421e5-109">T336 innehåller också de temporära data på sidan **Artikelspårningsrader** för artikelspårning av antal som återstår att faktureras.</span><span class="sxs-lookup"><span data-stu-id="421e5-109">T336 also hold the temporary data in the **Item Tracking Lines page** for item tracking quantities that remain to be invoiced.</span></span>  
  
## <a name="one-to-many-relation"></a><span data-ttu-id="421e5-110">En-till-många-relation</span><span class="sxs-lookup"><span data-stu-id="421e5-110">One-to-Many Relation</span></span>  
<span data-ttu-id="421e5-111">Tabellen **Artikeltrans. relation** som används för att koppla en bokförd dokumentrad med dess relaterade artikeltransaktioner, består av två delar:</span><span class="sxs-lookup"><span data-stu-id="421e5-111">The **Item Entry Relation** table, which is used to link a posted document line with its related item ledger entries, consists of two main parts:</span></span>  
  
* <span data-ttu-id="421e5-112">En pekare till den bokförda dokumentraden, fältet **Orderradnr**.</span><span class="sxs-lookup"><span data-stu-id="421e5-112">A pointer to the posted document line, the **Order Line No.**</span></span> <span data-ttu-id="421e5-113">.</span><span class="sxs-lookup"><span data-stu-id="421e5-113">field.</span></span>  
* <span data-ttu-id="421e5-114">Ett löpnummer som pekar på en artikeltransaktion, fältet **Artikellöpnr**.</span><span class="sxs-lookup"><span data-stu-id="421e5-114">An entry number pointing to an item ledger entry, the **Item Entry No.** field.</span></span>  
  
<span data-ttu-id="421e5-115">Funktionen för det befintliga fältet **Löpnr**, som gäller en artikeltransaktion till en bokförd dokumentrad, hanterar den typiska ett-till- ett-relationen när inget artikelspårningsnummer finns på den bokförda dokumentraden.</span><span class="sxs-lookup"><span data-stu-id="421e5-115">The functionality of the existing **Entry No.** field, which relates an item ledger entry to a posted document line, handles the typical one-to-one relation when no item tracking numbers exist on the posted document line.</span></span> <span data-ttu-id="421e5-116">Om artikelspårningsnummer finns är fältet **Löpnr** tom och en-till-flera-relationen hanteras av tabellen **Artikeltrans. relation**.</span><span class="sxs-lookup"><span data-stu-id="421e5-116">If item tracking numbers exist, then the **Entry No.** field is left blank, and the one-to-many relation is handled by the **Item Entry Relation** table.</span></span> <span data-ttu-id="421e5-117">Om den bokförda dokumentraden har artikelspårningsnummer men endast är knuten till en enda artikeltransaktion, hanterar fältet **Löpnr** relationen och ingen transaktion skapas i tabellen **Artikeltrans. relation**.</span><span class="sxs-lookup"><span data-stu-id="421e5-117">If the posted document line carries item tracking numbers but only relates to a single item ledger entry, then the **Entry No.** field handles the relation, and the no record is created in the **Item Entry Relation** table.</span></span>  
  
## <a name="codeunits-80-and-90"></a><span data-ttu-id="421e5-118">Kodenhet 80 och 90</span><span class="sxs-lookup"><span data-stu-id="421e5-118">Codeunits 80 and 90</span></span>  
<span data-ttu-id="421e5-119">Om du vill dela artikeltransaktionerna vid bokföring omringas koden i kodenhet 80 och kodenhet 90 med loopar som körs via globala, tillfälliga postvariabler.</span><span class="sxs-lookup"><span data-stu-id="421e5-119">To split the item ledger entries during posting, the code in codeunit 80 and codeunit 90, is encircled by loops that run through global temporary record variables.</span></span> <span data-ttu-id="421e5-120">Koden anropar kodenhet 22 med en artikeljournalrad.</span><span class="sxs-lookup"><span data-stu-id="421e5-120">This code calls codeunit 22 with an item journal line.</span></span> <span data-ttu-id="421e5-121">Dessa variabler aktiveras när artikelspårningsnummer finns för dokumentraden.</span><span class="sxs-lookup"><span data-stu-id="421e5-121">These variables are initialized when item tracking numbers exist for the document line.</span></span> <span data-ttu-id="421e5-122">För att hålla koden enkel används alltid den här loopstrukturen.</span><span class="sxs-lookup"><span data-stu-id="421e5-122">To keep the code simple, this looping structure is always used.</span></span> <span data-ttu-id="421e5-123">Om inga artikelspårningsnummer finns för dokumentraden infogas en enda post, och loopen körs bara en gång.</span><span class="sxs-lookup"><span data-stu-id="421e5-123">If no item tracking numbers exist for the document line, then a single record is inserted, and the loop runs only once.</span></span>  
  
## <a name="posting-the-item-journal"></a><span data-ttu-id="421e5-124">Bokför artikeljournalen</span><span class="sxs-lookup"><span data-stu-id="421e5-124">Posting the Item Journal</span></span>  
<span data-ttu-id="421e5-125">Artikelspårningsnummer överförs via de Reservationstransaktioner som är relaterade till den aktuella artikeltransaktionen och upprepa format i artikelspårningsnummer automatiskt i kodmodul 22.</span><span class="sxs-lookup"><span data-stu-id="421e5-125">Item tracking numbers are transferred via the reservation entries that relate to the item ledger entry, and the looping through item tracking numbers occurs in codeunit 22.</span></span> <span data-ttu-id="421e5-126">Detta fungerar på samma sätt när en artikeljournalrad indirekt för att bokföra en försäljning eller inköp som när du använder en artikeljournalrad direkt.</span><span class="sxs-lookup"><span data-stu-id="421e5-126">This concept works in the same way when an item journal line is used indirectly to post a sale or purchase order as when an item journal line is used directly.</span></span> <span data-ttu-id="421e5-127">När artikeljournalen används direkt pekar fältet **Källrad-ID** på själva artikeljournalraden.</span><span class="sxs-lookup"><span data-stu-id="421e5-127">When the item journal is used directly, the **Source Row ID** field points to the item journal line itself.</span></span>  
  
## <a name="code-unit-22"></a><span data-ttu-id="421e5-128">Kodenhet 22</span><span class="sxs-lookup"><span data-stu-id="421e5-128">Code Unit 22</span></span>  
<span data-ttu-id="421e5-129">Kodenhet 80 och 90 tar anropet i kodenhet 22 i en loop under fakturabokföringen av artikelspårningsnummer och vid faktureringen av befintliga leveranser eller kvitton.</span><span class="sxs-lookup"><span data-stu-id="421e5-129">Codeunits 80 and 90 loop the call of codeunit 22 during the invoice posting of item tracking numbers and during the invoicing of existing shipments or receipts.</span></span>  
  
<span data-ttu-id="421e5-130">Under antalsbokföring av artikelspårningsnummer hämtar kodenhet 22 artikelspårningsnummer från transaktionerna i T337 som avser bokföringen.</span><span class="sxs-lookup"><span data-stu-id="421e5-130">During quantity posting of item tracking numbers, codeunit 22 retrieves item tracking numbers from the entries in T337 that relate to the posting.</span></span> <span data-ttu-id="421e5-131">Dessa transaktioner placeras direkt på artikeljournalraden.</span><span class="sxs-lookup"><span data-stu-id="421e5-131">These entries are placed directly on the item journal line.</span></span>  
  
<span data-ttu-id="421e5-132">Kodenhet 22 går i en loop via artikelspårningsnumren och delar upp bokföringen i de artikeltransaktioner som har artikelspårningsnumren.</span><span class="sxs-lookup"><span data-stu-id="421e5-132">Codeunit 22 loops through the item tracking numbers and splits the posting into the respective item ledger entries that carry the item tracking numbers.</span></span> <span data-ttu-id="421e5-133">Information om vilka artikeltransaktioner skapas tillbaka till T337 med hjälp av en temporär T336 post som anropas av en procedur i kodmodul 22.</span><span class="sxs-lookup"><span data-stu-id="421e5-133">Information about which item ledger entries are created is returned to T337 by using a temporary T336 record, which is called by a procedure in codeunit 22.</span></span> <span data-ttu-id="421e5-134">Den här proceduren utfärdas när kodmodul 22 är klar att köras eftersom samtidigt, kodmodul 22-objekt innehåller information.</span><span class="sxs-lookup"><span data-stu-id="421e5-134">This procedure is triggered when codeunit 22 has finished its run because at that point, the codeunit 22 object contains the information.</span></span> <span data-ttu-id="421e5-135">När det tillfälliga T336-posten hämtas skapar kodmodulerna 80 och 90 poster i tabellen **Artikeltrans. relation** för att koppla de skapade artikeltransaktionerna till den skapade utleverans- eller inleveransraden.</span><span class="sxs-lookup"><span data-stu-id="421e5-135">When the temporary T336 record is retrieved, codeunits 80 and 90 create records in the **Item Entry Relation** table to link the created item ledger entries to the created shipment or receipt line.</span></span> <span data-ttu-id="421e5-136">Kodenhet 80 eller 90 omvandla sedan de temporära T336-posterna till riktiga T336-poster som är kopplade till raden i fråga.</span><span class="sxs-lookup"><span data-stu-id="421e5-136">Codeunits 80 or codeunit 90 then converts the temporary T336 records to real T336 records that are related to the line in question.</span></span> <span data-ttu-id="421e5-137">Denna konvertering inträffar bara om den bokförda dokumentraden inte tas bort, eftersom det endast har bokförts delvis.</span><span class="sxs-lookup"><span data-stu-id="421e5-137">However, this conversion occurs only if the posted document line is not deleted, because it is only partially posted.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="421e5-138">Se även</span><span class="sxs-lookup"><span data-stu-id="421e5-138">See Also</span></span>  
<span data-ttu-id="421e5-139">[Designdetaljer: Objektspårning](design-details-item-tracking.md) </span><span class="sxs-lookup"><span data-stu-id="421e5-139">[Design Details: Item Tracking](design-details-item-tracking.md) </span></span>  
[<span data-ttu-id="421e5-140">Designdetaljer: Artikelkopplingsdesign</span><span class="sxs-lookup"><span data-stu-id="421e5-140">Design Details: Item Tracking Design</span></span>](design-details-item-tracking-design.md)